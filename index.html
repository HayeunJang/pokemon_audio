<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PokÃ©mon Name</title>

  <!-- jsPsych -->
  <link rel="stylesheet" href="https://unpkg.com/jspsych@8.0.0/css/jspsych.css">
  <script src="https://unpkg.com/jspsych@8.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-preload@2.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-html-button-response@2.0.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-survey-html-form@2.0.0"></script>

  <style>
    body { margin:0; padding:20px; font-family: Arial, sans-serif; }
    #jspsych-target { max-width: 900px; margin: 0 auto; }
    .row { display:flex; gap:16px; align-items:flex-start; }
    .col { flex:1; }
    .guide {
      max-width: 370px; border:1px solid #ddd; border-radius:8px; padding:12px; background:#fafafa;
      font-size: 13px; line-height: 1.35;
    }
    .guide img { width:100%; height:auto; display:block; border-radius:6px; }
    .prompt { margin:8px 0 12px; }
    .audio-wrap { margin:8px 0 12px; }
    .wait-note { font-size: 13px; color:#666; margin-top:4px; }
    .disabled-btn { opacity: .5; pointer-events: none; }
  </style>
</head>
<body>
<div id="jspsych-target"></div>

<script>
  /******************************************************
   * PokÃ©mon Name 2AFC (Audio pair in a single file)
   * - AB/BA íŒŒì¼ ì¤‘ ëœë¤ ì„ íƒ
   * - íƒ€ì… ê°€ì´ë“œ ì´ë¯¸ì§€ ê³ ì •
   * - Google Sheets ì—…ë¡œë“œ
   ******************************************************/

  /* ===== CONFIG ===== */
  const GAS_ENDPOINT = 'https://script.google.com/macros/s/AKfycbzVaMGOoMVXFuUyu8pN-yXW-r-QmpBuLmsB__UacNEZsVZSiys6Yh4fgsNWr5ShcPtRsg/exec'; 
  const TYPE_GUIDE_IMG = 'img/type_guide.png';  

  /* ===== TEXTS ===== */
  const TEXTS = {
    welcomeTitle: 'í¬ì¼“ëª¬ ì´ë¦„ ì„ íƒ',
    welcomeBody: `
    í¬ì¼“ëª¬ íƒ€ì…ì—ëŠ” ì—¬ëŸ¬ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.<br>
    ê·¸ ì¤‘ Flying, Dark, FairyëŠ” ì¼ë°˜ì ìœ¼ë¡œ Normalê³¼ ë¹„êµí•´ ì•„ë˜ì™€ ê°™ì€ íŠ¹ì§•ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.<br>
    - Flying íƒ€ì…: í•˜ëŠ˜ì„ ë‚œë‹¤ fly in the sky<br>
    - Dark íƒ€ì…: ì•…í•˜ë‹¤ villainous, evil<br>
    - Fairy íƒ€ì…: ê·€ì—½ë‹¤ cute<br><br>
    ì œì‹œëœ ê·¸ë¦¼ì€ <em>AIê°€ ìƒì„±í•œ ì°¸ê³ ìš© ì˜ˆì‹œ</em>ì´ë©° ì‹¤ì œ í¬ì¼“ëª¬ì´ ì•„ë‹™ë‹ˆë‹¤.<br><br>
    ê° trialì—ì„œ <strong>í•˜ë‚˜ì˜ ì˜¤ë””ì˜¤</strong>ì— <strong>ë‘ ê°œì˜ ì´ë¦„</strong>ì´ ìˆœì°¨ì ìœ¼ë¡œ ë“¤ë¦½ë‹ˆë‹¤.<br>
    ì˜¤ë””ì˜¤ë¥¼ ëê¹Œì§€ ë“¤ì€ ë’¤, ì œì‹œëœ <strong>íƒ€ê²Ÿ íƒ€ì…</strong>ì— ë” ì–´ìš¸ë¦¬ëŠ” ì´ë¦„ì„ ì„ íƒí•˜ì„¸ìš”.
    `,
    startBtn: 'ì‹œì‘',
    listenFirst: 'ì˜¤ë””ì˜¤ë¥¼ ëê¹Œì§€ ë“¤ì–´ì•¼ ë²„íŠ¼ì´ í™œì„±í™”ë©ë‹ˆë‹¤.',
    endTitle: 'ì‹¤í—˜ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!',
    endBody: 'ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ë°ì´í„°ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”.<br>ë°˜ë“œì‹œ ì—…ë¡œë“œ ì™„ë£Œ ë©”ì‹œì§€ë¥¼ í™•ì¸í•œ ë‹¤ìŒì— ì°½ì„ ë‹«ì•„ì£¼ì„¸ìš”.',
    finishBtn: 'ë°ì´í„° ì—…ë¡œë“œ'
  };

  /* ===== BASE TRIALS =====
   * ê° trialì€ íŒŒì¼ prefixë§Œ ì§€ì •í•˜ê³ , ì‹¤ì œ íŒŒì¼ì€ *_AB.wav / *_BA.wav ì¤‘
   * í•˜ë‚˜ë¥¼ ë¬´ì‘ìœ„ë¡œ ì„ íƒí•´ STIMULIë¡œ ìƒì„±í•©ë‹ˆë‹¤.
   */
  const BASE_TRIALS = [
    { id: "01", prefix: "01_", nameA: "Silshin",  nameB: "Tiltin",   target_type: "Flying"  },
    { id: "02", prefix: "02_", nameA: "Salshim",  nameB: "Taltim",  target_type: "Flying"   },
    { id: "03", prefix: "03_", nameA: "Sulshur",   nameB: "Tulkur",  target_type: "Flying" },
    { id: "04", prefix: "04_", nameA: "Surshum",    nameB: "Turkum",   target_type: "Flying" },
    { id: "05", prefix: "05_", nameA: "Shieshen",  nameB: "Kieten",   target_type: "Flying"  },
    { id: "06", prefix: "06_", nameA: "Shilsun",  nameB: "Kiltun",  target_type: "Flying"   },
    { id: "07", prefix: "07_", nameA: "Shalshick",   nameB: "Kaltick",  target_type: "Flying" },
    { id: "08", prefix: "08_", nameA: "Shelshim",    nameB: "Kelkim",   target_type: "Flying" },
    { id: "09", prefix: "09_", nameA: "Bringlin",  nameB: "Prinklin",   target_type: "Dark"  },
    { id: "10", prefix: "10_", nameA: "Branzlam",  nameB: "Pranslam",  target_type: "Dark"   },
    { id: "11", prefix: "11_", nameA: "Drinzlin",   nameB: "Trinslin",  target_type: "Dark" },
    { id: "12", prefix: "12_", nameA: "Dramblum",    nameB: "Tramplum",   target_type: "Dark" },
    { id: "13", prefix: "13_", nameA: "Grimblin",  nameB: "Krimplin",   target_type: "Dark"  },
    { id: "14", prefix: "14_", nameA: "Grenzlin",  nameB: "Krenslin",  target_type: "Dark"   },
    { id: "15", prefix: "15_", nameA: "Zegdum",   nameB: "Sektum",  target_type: "Dark" },
    { id: "16", prefix: "16_", nameA: "Zumgul",    nameB: "Sumkul",   target_type: "Dark" },
    { id: "17", prefix: "17_", nameA: "Peepol",   nameB: "Teetol",  target_type: "Fairy" },
    { id: "18", prefix: "18_", nameA: "Polpen",    nameB: "Tolken",   target_type: "Fairy" },
    { id: "19", prefix: "19_", nameA: "Pafpil",  nameB: "Tastil",   target_type: "Fairy"  },
    { id: "20", prefix: "20_", nameA: "Pimpock",  nameB: "Tintock",  target_type: "Fairy"   },
    { id: "21", prefix: "21_", nameA: "Paapair",   nameB: "Kaakair",  target_type: "Fairy" },
    { id: "22", prefix: "22_", nameA: "Pupmir",    nameB: "Kukmir",   target_type: "Fairy" },
    { id: "23", prefix: "23_", nameA: "Pepmil",   nameB: "Kekmil",  target_type: "Fairy" },
    { id: "24", prefix: "24_", nameA: "Parpil",    nameB: "Karkil",   target_type: "Fairy" },
  ];

  function pickRandom(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

  // AB / BA ì¤‘ ë¬´ì‘ìœ„ ì„ íƒí•˜ì—¬ STIMULI ìƒì„±
  const STIMULI = BASE_TRIALS.map(t => {
    const chosen = pickRandom(["AB", "BA"]);
    const audioPath = `./audio/${t.prefix}${chosen}.wav`;
    const targetType = String(t.target_type);
    
    // stimulus HTML ë¯¸ë¦¬ ìƒì„± - ê·¸ë¦¼ì´ ë§¨ ìœ„
    const stimulus_html = `
      <div style="max-width: 700px; margin: 0 auto;">
        <div style="text-align: center; margin-bottom: 20px;">
          <img src="${TYPE_GUIDE_IMG}" alt="Type guide" style="max-width: 400px; width: 100%; height: auto; border-radius: 8px; border: 1px solid #ddd;">
          <div style="font-size: 13px; color: #666; margin-top: 8px;">ê·¸ë¦¼: íƒ€ì… ê°€ì´ë“œ (ì°¸ê³ ìš©, AI ìƒì„±)</div>
        </div>
        
        <div class="prompt" style="text-align: center; margin: 20px 0;">
          ì–´ë–¤ ì´ë¦„ì´ <strong>${targetType}-type PokÃ©mon</strong>ì— ë” ì–´ìš¸ë¦¬ë‚˜ìš”?
        </div>
        
        <div class="audio-wrap" style="text-align: center;">
          <audio id="stimAudio" controls preload="auto">
            <source src="${audioPath}" type="audio/wav"/>
            ë¸Œë¼ìš°ì €ê°€ ì˜¤ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
          </audio>
          <div class="wait-note">${TEXTS.listenFirst}</div>
        </div>
      </div>
    `;
    
    return {
      id: t.id,
      audio_path: audioPath,
      nameA: String(t.nameA),
      nameB: String(t.nameB),
      target_type: targetType,
      chosen_version: chosen,   // ë¶„ì„ ì‹œ ì‚¬ìš©
      stimulus_html: stimulus_html
    };
  });

  // ì§„ë‹¨: ì˜¤ë””ì˜¤ íŒŒì¼ ì ‘ê·¼ ê°€ëŠ¥ ì—¬ë¶€ ë¡œê·¸
  STIMULI.forEach(s => {
    fetch(s.audio_path, { method: 'HEAD' })
      .then(r => console.log(`[CHECK] ${s.audio_path} -> ${r.status}`))
      .catch(e => console.warn(`[CHECK] ${s.audio_path} fetch error`, e));
  });

  
  /* ===== INIT ===== */
  let jsPsych = initJsPsych({
    display_element: 'jspsych-target',
    on_finish: async () => {
      console.log('ì‹¤í—˜ ì¢…ë£Œ - ë°ì´í„° ì—…ë¡œë“œ ì¤‘...');
      
      // Google Sheets ì—…ë¡œë“œ ì‹œë„
      await uploadAllRowsToGoogle();
      
      // ê°ì‚¬ ë©”ì‹œì§€ í‘œì‹œ
      const target = document.getElementById('jspsych-target');
      target.innerHTML = `
        <div style="text-align: center; padding: 40px;">
          <h2>ì°¸ì—¬í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!</h2>
          <p style="font-size: 16px; margin: 20px 0;">ë°ì´í„° ì—…ë¡œë“œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
          <p style="font-size: 14px; color: #666;">
            ì´ì œ ì°½ì„ ë‹«ìœ¼ì…”ë„ ë©ë‹ˆë‹¤.
          </p>
        </div>
      `;
      
      // ë°±ì—…ìš© CSV ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ìƒì„± (ì„ íƒì‚¬í•­)
      const csv = jsPsych.data.get().csv();
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `pokemon_data_${new Date().getTime()}.csv`;
      a.textContent = 'ğŸ“¥ ë°±ì—… íŒŒì¼ ë‹¤ìš´ë¡œë“œ (ì„ íƒ)';
      a.style.display = 'block';
      a.style.margin = '20px auto';
      a.style.padding = '10px 20px';
      a.style.textAlign = 'center';
      a.style.fontSize = '14px';
      a.style.color = '#666';
      a.style.backgroundColor = '#f5f5f5';
      a.style.textDecoration = 'none';
      a.style.borderRadius = '6px';
      a.style.border = '1px solid #ddd';
      a.style.width = 'fit-content';
      document.body.appendChild(a);
    }
  });

  

  /* ===== PRELOAD ===== */
  const preload = {
    type: jsPsychPreload,
    audio: STIMULI.map(s => s.audio_path),
    images: [TYPE_GUIDE_IMG],
  };

  /* ===== WELCOME ===== */
  const welcome = {
    type: jsPsychHtmlButtonResponse,
    stimulus: `
      <div style="max-width: 700px; margin: 0 auto;">
        <h2 style="text-align: center;">${TEXTS.welcomeTitle}</h2>
        
        <div style="text-align: center; margin: 20px 0;">
          <img src="${TYPE_GUIDE_IMG}" alt="Type guide" style="max-width: 400px; width: 100%; height: auto; border-radius: 8px; border: 1px solid #ddd;">
          <div style="font-size: 13px; color: #666; margin-top: 8px;">ê·¸ë¦¼: íƒ€ì… ê°€ì´ë“œ (ì°¸ê³ ìš©, AI ìƒì„±)</div>
        </div>
        
        <div style="text-align: left; line-height: 1.6;">
          ${TEXTS.welcomeBody}
        </div>
      </div>
    `,
    choices: [TEXTS.startBtn]
  };

  /* ===== 2AFC TRIAL ===== */
  let currentTrialStartTime = null;   // trial ì‹œì‘ ì‹œê°

  const twoAFC_trial = {
    type: jsPsychHtmlButtonResponse,
    stimulus: function() {
      const data = jsPsych.evaluateTimelineVariable('target_type');
      return jsPsych.timelineVariable('stimulus_html');
    },
    // ë²„íŠ¼ ë¼ë²¨: ì˜¤ë””ì˜¤ ìˆœì„œ ê·¸ëŒ€ë¡œ (ì²« ë²ˆì§¸ ì´ë¦„, ë‘ ë²ˆì§¸ ì´ë¦„)
    choices: ['ì²« ë²ˆì§¸ ì´ë¦„', 'ë‘ ë²ˆì§¸ ì´ë¦„'],
    response_allowed_while_playing: true, // ë³´ì´ê¸´ í•˜ì§€ë§Œ on_loadì—ì„œ ì ê¸ˆ
    button_html: (choice, i) =>
      `<button class="jspsych-btn disabled-btn" data-btn-index="${i}" disabled>${choice}</button>`,
    on_load: () => {
      currentTrialStartTime = new Date().toISOString();

      // ë²„íŠ¼ ì ê¸ˆ
      const btns = document.querySelectorAll('button.jspsych-btn');
      btns.forEach(b => { b.disabled = true; b.classList.add('disabled-btn'); });

      // ì˜¤ë””ì˜¤ ëë‚˜ë©´ ë²„íŠ¼ í•´ì œ
      const audio = document.getElementById('stimAudio');
      if (audio) {
        const enable = () => {
          btns.forEach(b => { b.disabled = false; b.classList.remove('disabled-btn'); });
        };
        audio.addEventListener('ended', enable, { once: true });
      }
    },
    on_finish: (data) => {
      const chosenIndex = data.response; // 0 = ì²« ë²ˆì§¸ ì´ë¦„, 1 = ë‘ ë²ˆì§¸ ì´ë¦„
      const nameA = jsPsych.evaluateTimelineVariable('nameA');
      const nameB = jsPsych.evaluateTimelineVariable('nameB');
      const chosenVersion = jsPsych.evaluateTimelineVariable('chosen_version'); // 'AB' or 'BA'
      
      // chosen_versionì— ë”°ë¼ ì‹¤ì œ ì„ íƒëœ ì´ë¦„ ê²°ì •
      let chosenName;
      
      if (chosenVersion === 'AB') {
        // AB ë²„ì „: ì²« ë²ˆì§¸=A, ë‘ ë²ˆì§¸=B
        chosenName = chosenIndex === 0 ? nameA : nameB;
      } else {
        // BA ë²„ì „: ì²« ë²ˆì§¸=B, ë‘ ë²ˆì§¸=A
        chosenName = chosenIndex === 0 ? nameB : nameA;
      }

      console.log('currentTrialStartTime:', currentTrialStartTime);
      console.log('typeof currentTrialStartTime:', typeof currentTrialStartTime);

      data.task            = '2afc';
      data.target_type     = jsPsych.evaluateTimelineVariable('target_type');
      data.audio_file      = jsPsych.evaluateTimelineVariable('audio_path');
      data.nameA           = nameA;
      data.nameB           = nameB;
      data.trial_id        = jsPsych.evaluateTimelineVariable('id');
      data.chosen_version  = chosenVersion;
      data.choice_order    = ['ì²« ë²ˆì§¸ ì´ë¦„', 'ë‘ ë²ˆì§¸ ì´ë¦„']; // ê³ ì • ìˆœì„œ
      data.button_response = chosenIndex === 0 ? 'ì²« ë²ˆì§¸ ì´ë¦„' : 'ë‘ ë²ˆì§¸ ì´ë¦„'; // ë²„íŠ¼ ì„ íƒ
      data.chosen_name     = chosenName;
      data.trial_start_time= currentTrialStartTime;
      data.response_time   = new Date().toISOString();
      data.user_agent      = navigator.userAgent;
      
      console.log('data.trial_start_time:', data.trial_start_time);
      console.log('data.response_time:', data.response_time);
    }
  };

  /* ===== DEMOGRAPHICS ===== */
    const demographics = {
      type: jsPsychSurveyHtmlForm,
      preamble: '<h3>ì°¸ê°€ì ì •ë³´</h3><p>ì•„ë˜ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>',
      html: `
        <div style="text-align: left; max-width: 500px; margin: 0 auto;">
          <p><label for="gender"><strong>ì„±ë³„(ì„ íƒ):</strong></label><br>
          <input type="radio" name="gender" value="ë‚¨" required> ë‚¨
          <input type="radio" name="gender" value="ì—¬" required> ì—¬</p>
          
          <p><label for="birth_year"><strong>íƒœì–´ë‚œ í•´:</strong></label><br>
          <input type="text" id="birth_year" name="birth_year" placeholder="YYYY (ì˜ˆ: 1995)" pattern="[0-9]{4}" required style="width: 150px;"></p>
          
          <p><label for="birth_month"><strong>íƒœì–´ë‚œ ì›”:</strong></label><br>
          <input type="text" id="birth_month" name="birth_month" placeholder="MM (ì˜ˆ: 03)" pattern="[0-9]{2}" required style="width: 80px;"></p>
          
          <p><label for="native_lang"><strong>ëª¨êµ­ì–´:</strong></label><br>
          <input type="text" id="native_lang" name="native_lang" placeholder="ì˜ˆ: í•œêµ­ì–´" required style="width: 200px;"></p>
          
          <p><label for="foreign_lang"><strong>ì˜ì–´ ìˆ˜ì¤€:</strong></label><br>
          <label><input type="radio" name="foreign_lang" value="ë‚®ìŒ" required> ë‚®ìŒ</label>
          <label><input type="radio" name="foreign_lang" value="ë³´í†µ" required> ë³´í†µ</label>
          <label><input type="radio" name="foreign_lang" value="ë†’ìŒ" required> ë†’ìŒ</label></p>

          <p><strong>í¬ì¼“ëª¬ ì¹œìˆ™ë„(ì„ íƒ):</strong><br>
          <label><input type="radio" name="pkmn_familiarity" value="ë‚®ìŒ" required> ë‚®ìŒ</label>
          <label><input type="radio" name="pkmn_familiarity" value="ë³´í†µ" required> ë³´í†µ</label>
          <label><input type="radio" name="pkmn_familiarity" value="ë†’ìŒ" required> ë†’ìŒ</label></p>
        </div>
      `,
      button_label: 'ì œì¶œ',
      data: { task: 'demographics' },
      on_finish: (data) => {
        data.user_agent = navigator.userAgent;
        data.timestamp = new Date().toISOString();
        console.log('Demographics:', data.response);
      }
    };
  /* ===== END ===== */
  const end = {
    type: jsPsychHtmlButtonResponse,
    stimulus: `<h2>${TEXTS.endTitle}</h2><p>${TEXTS.endBody}</p>`,
    choices: [TEXTS.finishBtn]
  };

  /* ===== BLOCK & RUN ===== */
  const trials_block = {
    timeline: [twoAFC_trial],
    timeline_variables: STIMULI,
    randomize_order: true
  };

  jsPsych.run([preload, welcome, trials_block, demographics, end]);

  /* ===== GOOGLE SHEETS UPLOAD ===== */
  async function uploadAllRowsToGoogle() {
    console.log('=== ì—…ë¡œë“œ ì‹œì‘ ===');
    console.log('GAS_ENDPOINT:', GAS_ENDPOINT);
    
    if (!GAS_ENDPOINT || GAS_ENDPOINT.startsWith('PASTE_')) {
      console.warn('No GAS endpoint configured.');
      return false;
    }
    try {
      const all = jsPsych.data.get().values();
      console.log('ì „ì²´ ë°ì´í„° ê°œìˆ˜:', all.length);
      
      const demo = all.find(d => d.task === 'demographics');
      console.log('Demographics ì°¾ìŒ:', demo ? 'Yes' : 'No');
      const dmo  = demo?.response || {};
      console.log('Demographics ë‚´ìš©:', dmo);

      const rows = all
        .filter(d => d.task === '2afc')
        .map(d => {
          const { rt, ...rest } = d; // rt ì œê±°
          return {
            trial_index:      rest.trial_index,
            task:             rest.task,
            trial_id:         rest.trial_id || '',
            chosen_version:   rest.chosen_version || '',
            target_type:      rest.target_type,
            audio_file:       rest.audio_file,
            nameA:            rest.nameA,
            nameB:            rest.nameB,
            choice_order:     JSON.stringify(rest.choice_order || []),
            button_response:  rest.button_response || '',
            chosen_name:      rest.chosen_name || '',
            time_elapsed:     rest.time_elapsed,
            trial_start_time: rest.trial_start_time || '',
            response_time:    rest.response_time || '',
            user_agent:       rest.user_agent || navigator.userAgent,
            gender:           dmo.gender || '',
            birth_year:       dmo.birth_year || '',
            birth_month:      dmo.birth_month || '',
            native_lang:      dmo.native_lang || '',
            foreign_lang:     dmo.foreign_lang || '',
            pkmn_familiarity: dmo.pkmn_familiarity || ''
          };
        });

      console.log('2afc ë°ì´í„° ê°œìˆ˜:', rows.length);
      console.log('ì²« ë²ˆì§¸ row:', rows[0]);
      
      const payload = { data: rows };
      console.log('ì „ì†¡í•  payload:', payload);
      console.log('Payload JSON ê¸¸ì´:', JSON.stringify(payload).length);

      console.log('fetch ì‹œì‘...');
      
      // no-cors ëª¨ë“œë¡œ ì „ì†¡ (CORS ì—ëŸ¬ íšŒí”¼)
      const response = await fetch(GAS_ENDPOINT, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      console.log('fetch ì™„ë£Œ');
      console.log('Response type:', response.type);
      console.log('Response status:', response.status);
      console.log('Upload attempted. Check your Google Sheet NOW!');
      
      // 5ì´ˆ í›„ì— ë‹¤ì‹œ í™•ì¸ ë©”ì‹œì§€
      setTimeout(() => {
        console.log('5ì´ˆ ê²½ê³¼ - Google Sheets í™•ì¸í•˜ì„¸ìš”!');
      }, 5000);
      
      return true;
    } catch (e) {
      console.error('=== ì—…ë¡œë“œ ì—ëŸ¬ ===');
      console.error('Error:', e);
      console.error('Error message:', e.message);
      console.error('Error stack:', e.stack);
      return false;
    }
  }
</script>
</body>
</html>
